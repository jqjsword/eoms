define(["./when-208fe5b0","./Cartesian2-716c2715","./GeometryOffsetAttribute-d63c288d","./Transforms-f1816abc","./ComponentDatatype-549ec0d3","./Check-d18af7c4","./GeometryAttribute-0ee94cf1","./GeometryAttributes-b0b294d8","./IndexDatatype-d9b71b2b","./Math-3ba16bed","./PolygonPipeline-ac89187a","./RectangleGeometryLibrary-2356d7aa","./RuntimeError-7f634f5d","./WebGLConstants-76bb35d1","./EllipsoidRhumbLine-886cd793"],function(d,s,p,c,m,f,_,v,E,g,h,A,e,t,i){"use strict";var y=new c.BoundingSphere,b=new c.BoundingSphere,w=new s.Cartesian3,G=new s.Rectangle;function R(e,t){var i=e._ellipsoid,r=t.height,a=t.width,n=t.northCap,o=t.southCap,l=r,u=2,s=0,e=4;n&&(--u,--l,s+=1,e-=2),o&&(--u,--l,s+=1,e-=2),s+=u*a+2*l-e;var d,p=new Float64Array(3*s),c=0,f=0,g=w;if(n)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,0,g),p[c++]=g.x,p[c++]=g.y,p[c++]=g.z;else for(d=0;d<a;d++)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,d,g),p[c++]=g.x,p[c++]=g.y,p[c++]=g.z;for(d=a-1,f=1;f<r;f++)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,d,g),p[c++]=g.x,p[c++]=g.y,p[c++]=g.z;if(f=r-1,!o)for(d=a-2;0<=d;d--)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,d,g),p[c++]=g.x,p[c++]=g.y,p[c++]=g.z;for(d=0,f=r-2;0<f;f--)A.RectangleGeometryLibrary.computePosition(t,i,!1,f,d,g),p[c++]=g.x,p[c++]=g.y,p[c++]=g.z;for(var o=p.length/3*2,h=E.IndexDatatype.createTypedArray(p.length/3,o),y=0,b=0;b<p.length/3-1;b++)h[y++]=b,h[y++]=b+1;h[y++]=p.length/3-1,h[y++]=0;o=new _.Geometry({attributes:new v.GeometryAttributes,primitiveType:_.PrimitiveType.LINES});return o.attributes.position=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:p}),o.indices=h,o}function P(e){var t=(e=d.defaultValue(e,d.defaultValue.EMPTY_OBJECT)).rectangle,i=d.defaultValue(e.granularity,g.CesiumMath.RADIANS_PER_DEGREE),r=d.defaultValue(e.ellipsoid,s.Ellipsoid.WGS84),a=d.defaultValue(e.rotation,0);if(!d.defined(t))throw new f.DeveloperError("rectangle is required.");if(s.Rectangle.validate(t),t.north<t.south)throw new f.DeveloperError("options.rectangle.north must be greater than options.rectangle.south");var n=d.defaultValue(e.height,0),o=d.defaultValue(e.extrudedHeight,n);this._rectangle=s.Rectangle.clone(t),this._granularity=i,this._ellipsoid=r,this._surfaceHeight=Math.max(n,o),this._rotation=a,this._extrudedHeight=Math.min(n,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}P.packedLength=s.Rectangle.packedLength+s.Ellipsoid.packedLength+5,P.pack=function(e,t,i){if(!d.defined(e))throw new f.DeveloperError("value is required");if(!d.defined(t))throw new f.DeveloperError("array is required");return i=d.defaultValue(i,0),s.Rectangle.pack(e._rectangle,t,i),i+=s.Rectangle.packedLength,s.Ellipsoid.pack(e._ellipsoid,t,i),i+=s.Ellipsoid.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=d.defaultValue(e._offsetAttribute,-1),t};var D=new s.Rectangle,L=s.Ellipsoid.clone(s.Ellipsoid.UNIT_SPHERE),C={rectangle:D,ellipsoid:L,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};P.unpack=function(e,t,i){if(!d.defined(e))throw new f.DeveloperError("array is required");t=d.defaultValue(t,0);var r=s.Rectangle.unpack(e,t,D);t+=s.Rectangle.packedLength;var a=s.Ellipsoid.unpack(e,t,L);t+=s.Ellipsoid.packedLength;var n=e[t++],o=e[t++],l=e[t++],u=e[t++],t=e[t];return d.defined(i)?(i._rectangle=s.Rectangle.clone(r,i._rectangle),i._ellipsoid=s.Ellipsoid.clone(a,i._ellipsoid),i._surfaceHeight=o,i._rotation=l,i._extrudedHeight=u,i._offsetAttribute=-1===t?void 0:t,i):(C.granularity=n,C.height=o,C.rotation=l,C.extrudedHeight=u,C.offsetAttribute=-1===t?void 0:t,new P(C))};var x=new s.Cartographic;return P.createGeometry=function(e){var t=e._rectangle,i=e._ellipsoid,r=A.RectangleGeometryLibrary.computeOptions(t,e._granularity,e._rotation,0,G,x);if(!g.CesiumMath.equalsEpsilon(t.north,t.south,g.CesiumMath.EPSILON10)&&!g.CesiumMath.equalsEpsilon(t.east,t.west,g.CesiumMath.EPSILON10)){var a,n,o,l,u=e._surfaceHeight,s=e._extrudedHeight;return u=!g.CesiumMath.equalsEpsilon(u,s,0,g.CesiumMath.EPSILON2)?(n=function(e,t){var i=e._surfaceHeight,r=e._extrudedHeight,a=e._ellipsoid,n=r,o=i,l=R(e,t),r=t.height,i=t.width,u=(e=h.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,a,!1)).length;(o=new Float64Array(2*u)).set(e),n=h.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,a),o.set(n,u),l.attributes.position.values=o,a=t.northCap,n=t.southCap,t=4,a&&--t,n&&--t;for(var t=2*(o.length/3+t),s=E.IndexDatatype.createTypedArray(o.length/3,t),u=o.length/6,d=0,p=0;p<u-1;p++)s[d++]=p,s[d++]=p+1,s[d++]=p+u,s[d++]=p+u+1;return s[d++]=u-1,s[d++]=0,s[d++]=u+u-1,s[d++]=u,s[d++]=0,s[d++]=u,r=a?r-1:(a=i-1,s[d++]=a,s[d++]=a+u,i+r-2),s[d++]=r,s[d++]=r+u,n||(r=i+r-1,s[d++]=r,s[d]=r+u),l.indices=s,l}(e,r),d.defined(e._offsetAttribute)&&(a=n.attributes.position.values.length/3,o=new Uint8Array(a),o=e._offsetAttribute===p.GeometryOffsetAttribute.TOP?p.arrayFill(o,1,0,a/2):(l=e._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,p.arrayFill(o,l)),n.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})),o=c.BoundingSphere.fromRectangle3D(t,i,u,b),s=c.BoundingSphere.fromRectangle3D(t,i,s,y),c.BoundingSphere.union(o,s)):((n=R(e,r)).attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(n.attributes.position.values,u,i,!1),d.defined(e._offsetAttribute)&&(r=n.attributes.position.values.length,r=new Uint8Array(r/3),l=e._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,p.arrayFill(r,l),n.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:r})),c.BoundingSphere.fromRectangle3D(t,i,u)),new _.Geometry({attributes:n.attributes,indices:n.indices,primitiveType:_.PrimitiveType.LINES,boundingSphere:u,offsetAttribute:e._offsetAttribute})}},function(e,t){return(e=d.defined(t)?P.unpack(e,t):e)._ellipsoid=s.Ellipsoid.clone(e._ellipsoid),e._rectangle=s.Rectangle.clone(e._rectangle),P.createGeometry(e)}});
//# sourceMappingURL=createRectangleOutlineGeometry.js.map
