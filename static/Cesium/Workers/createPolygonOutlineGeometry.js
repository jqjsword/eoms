define(["./when-208fe5b0","./Cartesian2-716c2715","./ArcType-dc1c5aee","./GeometryOffsetAttribute-d63c288d","./Transforms-f1816abc","./Check-d18af7c4","./ComponentDatatype-549ec0d3","./EllipsoidTangentPlane-8e486e83","./GeometryAttribute-0ee94cf1","./GeometryAttributes-b0b294d8","./GeometryInstance-73b5b8d6","./GeometryPipeline-df743242","./IndexDatatype-d9b71b2b","./Math-3ba16bed","./PolygonGeometryLibrary-7f112f2e","./PolygonPipeline-ac89187a","./RuntimeError-7f634f5d","./WebGLConstants-76bb35d1","./IntersectionTests-680c4e46","./Plane-f5dfabcd","./AttributeCompression-69c5b20c","./EncodedCartesian3-7a9c1496","./arrayRemoveDuplicates-28d5a12e","./EllipsoidRhumbLine-886cd793"],function(m,u,E,b,P,c,A,v,G,_,T,H,L,C,O,D,e,t,i,r,o,n,a,y){"use strict";var I=[],w=[];function f(e){if(c.Check.typeOf.object("options",e),c.Check.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),e.perPositionHeight&&m.defined(e.height))throw new c.DeveloperError("Cannot use both options.perPositionHeight and options.height");if(m.defined(e.arcType)&&e.arcType!==E.ArcType.GEODESIC&&e.arcType!==E.ArcType.RHUMB)throw new c.DeveloperError("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var t,i=e.polygonHierarchy,r=m.defaultValue(e.ellipsoid,u.Ellipsoid.WGS84),o=m.defaultValue(e.granularity,C.CesiumMath.RADIANS_PER_DEGREE),n=m.defaultValue(e.perPositionHeight,!1),a=n&&m.defined(e.extrudedHeight),y=m.defaultValue(e.arcType,E.ArcType.GEODESIC),s=m.defaultValue(e.height,0),l=m.defaultValue(e.extrudedHeight,s);a||(t=Math.max(s,l),l=Math.min(s,l),s=t),this._ellipsoid=u.Ellipsoid.clone(r),this._granularity=o,this._height=s,this._extrudedHeight=l,this._arcType=y,this._polygonHierarchy=i,this._perPositionHeight=n,this._perPositionHeightExtrude=a,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=O.PolygonGeometryLibrary.computeHierarchyPackedLength(i)+u.Ellipsoid.packedLength+8}f.pack=function(e,t,i){return c.Check.typeOf.object("value",e),c.Check.defined("array",t),i=m.defaultValue(i,0),i=O.PolygonGeometryLibrary.packPolygonHierarchy(e._polygonHierarchy,t,i),u.Ellipsoid.pack(e._ellipsoid,t,i),i+=u.Ellipsoid.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=m.defaultValue(e._offsetAttribute,-1),t[i]=e.packedLength,t};var h=u.Ellipsoid.clone(u.Ellipsoid.UNIT_SPHERE),g={polygonHierarchy:{}};return f.unpack=function(e,t,i){c.Check.defined("array",e),t=m.defaultValue(t,0);var r=O.PolygonGeometryLibrary.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var o=u.Ellipsoid.unpack(e,t,h);t+=u.Ellipsoid.packedLength;var n=e[t++],a=e[t++],y=e[t++],s=1===e[t++],l=1===e[t++],p=e[t++],d=e[t++],t=e[t];return(i=!m.defined(i)?new f(g):i)._polygonHierarchy=r,i._ellipsoid=u.Ellipsoid.clone(o,i._ellipsoid),i._height=n,i._extrudedHeight=a,i._granularity=y,i._perPositionHeight=l,i._perPositionHeightExtrude=s,i._arcType=p,i._offsetAttribute=-1===d?void 0:d,i.packedLength=t,i},f.fromPositions=function(e){return e=m.defaultValue(e,m.defaultValue.EMPTY_OBJECT),c.Check.defined("options.positions",e.positions),new f({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},f.createGeometry=function(e){var t=e._ellipsoid,i=e._granularity,r=e._polygonHierarchy,o=e._perPositionHeight,n=e._arcType,a=O.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(r,!o,t);if(0!==a.length){var y,s,l,p,d,u,c=[],f=C.CesiumMath.chordLength(i,t.maximumRadius),h=e._height,g=e._extrudedHeight;if(e._perPositionHeightExtrude||!C.CesiumMath.equalsEpsilon(h,g,0,C.CesiumMath.EPSILON2))for(y=0;y<a.length;y++)(p=function(e,t,i,r,o){var n,a=v.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,I);D.PolygonPipeline.computeWindingOrder2D(a)===D.WindingOrder.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var y=t.length,s=new Array(y),l=0;if(r)for(n=new Float64Array(2*y*3*2),b=0;b<y;++b){s[b]=l/3;var p=t[b],d=t[(b+1)%y];n[l++]=p.x,n[l++]=p.y,n[l++]=p.z,n[l++]=d.x,n[l++]=d.y,n[l++]=d.z}else{var u,c=0;if(o===E.ArcType.GEODESIC)for(b=0;b<y;b++)c+=O.PolygonGeometryLibrary.subdivideLineCount(t[b],t[(b+1)%y],i);else if(o===E.ArcType.RHUMB)for(b=0;b<y;b++)c+=O.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[b],t[(b+1)%y],i);for(n=new Float64Array(3*c*2),b=0;b<y;++b){s[b]=l/3,o===E.ArcType.GEODESIC?u=O.PolygonGeometryLibrary.subdivideLine(t[b],t[(b+1)%y],i,w):o===E.ArcType.RHUMB&&(u=O.PolygonGeometryLibrary.subdivideRhumbLine(e,t[b],t[(b+1)%y],i,w));for(var f=u.length,h=0;h<f;++h)n[l++]=u[h]}}for(var y=n.length/6,g=s.length,r=2*(2*y+g),m=L.IndexDatatype.createTypedArray(y+g,r),l=0,b=0;b<y;++b)m[l++]=b,m[l++]=(b+1)%y,m[l++]=b+y,m[l++]=(b+1)%y+y;for(b=0;b<g;b++){var P=s[b];m[l++]=P,m[l++]=P+y}return new T.GeometryInstance({geometry:new G.Geometry({attributes:new _.GeometryAttributes({position:new G.GeometryAttribute({componentDatatype:A.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:m,primitiveType:G.PrimitiveType.LINES})})}(t,a[y],f,o,n)).geometry=O.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(p.geometry,h,g,t,o),m.defined(e._offsetAttribute)&&(s=p.geometry.attributes.position.values.length/3,l=new Uint8Array(s),l=e._offsetAttribute===b.GeometryOffsetAttribute.TOP?b.arrayFill(l,1,0,s/2):(u=e._offsetAttribute===b.GeometryOffsetAttribute.NONE?0:1,b.arrayFill(l,u)),p.geometry.attributes.applyOffset=new G.GeometryAttribute({componentDatatype:A.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:l})),c.push(p);else for(y=0;y<a.length;y++)(p=function(e,t,i,r,o){var n,a=v.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,I);D.PolygonPipeline.computeWindingOrder2D(a)===D.WindingOrder.CLOCKWISE&&(a.reverse(),t=t.slice().reverse());var y=t.length,s=0;if(r)for(n=new Float64Array(2*y*3),g=0;g<y;g++){var l=t[g],p=t[(g+1)%y];n[s++]=l.x,n[s++]=l.y,n[s++]=l.z,n[s++]=p.x,n[s++]=p.y,n[s++]=p.z}else{var d,u=0;if(o===E.ArcType.GEODESIC)for(g=0;g<y;g++)u+=O.PolygonGeometryLibrary.subdivideLineCount(t[g],t[(g+1)%y],i);else if(o===E.ArcType.RHUMB)for(g=0;g<y;g++)u+=O.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[g],t[(g+1)%y],i);for(n=new Float64Array(3*u),g=0;g<y;g++){o===E.ArcType.GEODESIC?d=O.PolygonGeometryLibrary.subdivideLine(t[g],t[(g+1)%y],i,w):o===E.ArcType.RHUMB&&(d=O.PolygonGeometryLibrary.subdivideRhumbLine(e,t[g],t[(g+1)%y],i,w));for(var c=d.length,f=0;f<c;++f)n[s++]=d[f]}}for(var r=2*(y=n.length/3),h=L.IndexDatatype.createTypedArray(y,r),s=0,g=0;g<y-1;g++)h[s++]=g,h[s++]=g+1;return h[s++]=y-1,h[s++]=0,new T.GeometryInstance({geometry:new G.Geometry({attributes:new _.GeometryAttributes({position:new G.GeometryAttribute({componentDatatype:A.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:h,primitiveType:G.PrimitiveType.LINES})})}(t,a[y],f,o,n)).geometry.attributes.position.values=D.PolygonPipeline.scaleToGeodeticHeight(p.geometry.attributes.position.values,h,t,!o),m.defined(e._offsetAttribute)&&(d=p.geometry.attributes.position.values.length,d=new Uint8Array(d/3),u=e._offsetAttribute===b.GeometryOffsetAttribute.NONE?0:1,b.arrayFill(d,u),p.geometry.attributes.applyOffset=new G.GeometryAttribute({componentDatatype:A.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})),c.push(p);r=H.GeometryPipeline.combineInstances(c)[0],i=P.BoundingSphere.fromVertices(r.attributes.position.values);return new G.Geometry({attributes:r.attributes,indices:r.indices,primitiveType:r.primitiveType,boundingSphere:i,offsetAttribute:e._offsetAttribute})}},function(e,t){return(e=m.defined(t)?f.unpack(e,t):e)._ellipsoid=u.Ellipsoid.clone(e._ellipsoid),f.createGeometry(e)}});
//# sourceMappingURL=createPolygonOutlineGeometry.js.map
